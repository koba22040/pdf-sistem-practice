# PDF入力支援システム

## 概要
このプロジェクトは、既存のPDFファイルに対して「入力枠（テキスト、チェックボックス、丸囲み）」をGUI上で配置し、その設定を元に**Googleフォームと連携した自動PDF生成システム**を構築するための支援ツールです。

## 主な機能

### 1. PDFテンプレート作成
*   **配置**: PDFを背景に、テキストボックスや図形（丸・チェック）をドラッグ＆ドロップで配置。
*   **グループ化**:
    *   **日付グループ**: 年・月・日をまとめてカレンダー入力に対応。自動入力で「時・分」もサポート。
    *   **文字分割**: 「フリガナ」などのマス目入力用に、1文字ずつ枠を分割。
*   **自動判定 (AutoFill)**:
    *   ある項目の入力値（例: 学籍番号の先頭、ラジオボタンの選択）に応じて、別の項目（例: 学部名、控除有無）を自動入力するルールを設定可能。
    *   ルールのプリセット保存・読み込み機能搭載。

### 2. Googleフォーム連携ウィザード
*   設定した配置情報を元に、**Google Apps Script (GAS)** 用のコードを自動生成。
*   生成されたコードをGoogleフォームのスクリプトエディタに貼り付けるだけで、フォーム回答内容をPDFに転記・自動生成するシステムが完成します。

### 3. UI/UX
*   **Undo/Redo**: 操作の取り消し・やり直しが可能 (`Ctrl+Z`)。
*   **自動保存**: 作業内容はブラウザ（LocalStorage）に自動保存され、いつでも再開可能。
*   **モダンなUI**: Google Material Designライクなツールバーと、操作しやすいモーダル配置。

## ファイル構成 (`modules/` アーキテクチャ)

フレームワークを使わず、ES Modulesによるモジュール分割構成を採用しています。

*   `index.html`: アプリケーションのメインUI構造。
*   `style.css`: スタイル定義。
*   `script.js`: エントリーポイント。初期化処理とウィザード関連のロジック。
*   **`modules/`**:
    *   `state.js`: アプリケーション全体の状態管理（配置データ、UI状態）。
    *   `canvas.js`: PDFと入力枠の描画ロジック。
    *   `events.js`: マウス・キーボードイベントのハンドリング。
    *   `ui.js`: DOM操作、モーダル、サイドバーの制御。
    *   `actions.js`: 自動入力やグループ化など、ビジネスロジックの実行。
    *   `file.js`: ファイルの読み込み・保存、LocalStorage連携。
    *   `history.js`: Undo機能のための履歴管理。
    *   `datetime.js`: 日付処理のユーティリティ。

## 使い方

1.  **PDFの読み込み**: 対象となるPDFファイルをドラッグ＆ドロップします。
2.  **フィールドの配置**: ツールバーから「テキスト配置」などを選び、PDF上の入力させたい場所をクリックまたはドラッグします。
3.  **設定**: 必要に応じて「グループ化」や「自動判定」を設定します。
4.  **テンプレート保存**: 右上の「テンプレート保存」ボタンを押すと、設定ファイル（JSON）と必要な素材がZIPでダウンロードされます。
5.  **システム構築**: 画面に表示されるウィザードに従い、GoogleドライブとGASを設定することで、連携システムが稼働します。

## 開発者向けメモ
*   **フォント**: 現在はGoogleドライブ上のフォントファイルを参照する仕様になっています。
*   **依存ライブラリ**: `pdf.js` (PDF表示), `pdf-lib` (PDF生成), `flatpickr` (カレンダーUI), `jszip` (保存用)。これらはCDN経由で読み込まれています。
